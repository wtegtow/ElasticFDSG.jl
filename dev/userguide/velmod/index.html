<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Velocity Models · ElasticFDSG.jl</title><meta name="title" content="Velocity Models · ElasticFDSG.jl"/><meta property="og:title" content="Velocity Models · ElasticFDSG.jl"/><meta property="twitter:title" content="Velocity Models · ElasticFDSG.jl"/><meta name="description" content="Documentation for ElasticFDSG.jl."/><meta property="og:description" content="Documentation for ElasticFDSG.jl."/><meta property="twitter:description" content="Documentation for ElasticFDSG.jl."/><meta property="og:url" content="https://wtegtow.github.io/ElasticFDSG.jl/userguide/velmod/"/><meta property="twitter:url" content="https://wtegtow.github.io/ElasticFDSG.jl/userguide/velmod/"/><link rel="canonical" href="https://wtegtow.github.io/ElasticFDSG.jl/userguide/velmod/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="ElasticFDSG.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ElasticFDSG.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../intro/">General Usage</a></li><li class="is-active"><a class="tocitem" href>Velocity Models</a><ul class="internal"><li><a class="tocitem" href="#2D"><span>2D</span></a></li><li><a class="tocitem" href="#3D"><span>3D</span></a></li></ul></li><li><a class="tocitem" href="../config/">Configurations</a></li></ul></li><li><a class="tocitem" href="../../method/">Method</a></li><li><a class="tocitem" href="../../reference/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User Guide</a></li><li class="is-active"><a href>Velocity Models</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Velocity Models</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/wtegtow/ElasticFDSG.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/wtegtow/ElasticFDSG.jl/blob/main/docs/src/userguide/velmod.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Velocity-Models"><a class="docs-heading-anchor" href="#Velocity-Models">Velocity Models</a><a id="Velocity-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Velocity-Models" title="Permalink"></a></h1><p>Velocity models can be prepared in .jld2 (Julia) or .npy/.npz (Python) formats.  This gives users the freedom to design their velocity models in the tool of their choice and adapt them to the required format.  The following explains the required structure for 2D and 3D models and shows how to create simple velocity models in Julia.</p><p><strong>Note:</strong> To simplify the creation of velocity models, all elastic parameters are defined on full-integer grid points in the staggered grid.</p><h2 id="2D"><a class="docs-heading-anchor" href="#2D">2D</a><a id="2D-1"></a><a class="docs-heading-anchor-permalink" href="#2D" title="Permalink"></a></h2><p>The 2D solver expects an (7, ny, nx) array with:</p><ul><li>1: X - 2D meshgrid coordinates</li><li>2: Y - 2D meshgrid coordinates </li><li>3: P-wave velocities [m/s]</li><li>4: S-wave velocities [m/s]</li><li>5: Densities [kg/m<span>$^{3}$</span>]</li><li>6: 2D Thomsen Parameter <span>$\epsilon$</span> </li><li>7: 2D Thomsen Parameter <span>$\delta$</span> </li></ul><p>For an isotropic medium, set 6 &amp; 7 zero.</p><p>The following script shows how to create a simple 2D velocity model.</p><pre><code class="language-julia hljs">
using JLD2

# spatial extends
x_start = 0
x_end = 10000

y_start = 0 
y_end = 10000

dx = 10 # cell size x-direction 
dy = 10 # cell size y-direction 

xcoords = x_start:dx:x_end # x-coordinates
ycoords = y_start:dy:y_end # y-coordinates

nx = length(xcoords) # number of grid points x-direction
ny = length(ycoords) # number of grid points y-direction

dim = (ny, nx) # model dimensions 

# 2D meshgrid
X = repeat(xcoords&#39;, ny, 1)
Y = repeat(ycoords,  1, nx)

vp = zeros(dim);   # P-wave velocity
vs = zeros(dim);   # S-wave velocity
rho = zeros(dim);  # Density
eps0 = zeros(dim); # 2D Thomson parameter epsilon
del0 = zeros(dim); # 2D Thomson parameter delta

# fill arrays with values
vp[:,:]  .= 5000;  
vs[:,:]  .= 2500;
rho[:,:] .= 2800;

# thomson parameter for vti media (zero for isotropic medium)
eps0[:,:] .= 0.2
del0[:,:] .= -0.15

# velocity model array
veldim = (7, ny, nx)
velmod = zeros(veldim)
# fill with elastic properties
velmod[1,:,:] .= X
velmod[2,:,:] .= Y
velmod[3,:,:] .= vp
velmod[4,:,:] .= vs
velmod[5,:,:] .= rho
velmod[6,:,:] .= eps0
velmod[7,:,:] .= del0

# save the velocity model
path = joinpath(@__DIR__,&quot;velmod.jld2&quot;) # add your actual path here 
jldsave(path; velmod)</code></pre><h2 id="3D"><a class="docs-heading-anchor" href="#3D">3D</a><a id="3D-1"></a><a class="docs-heading-anchor-permalink" href="#3D" title="Permalink"></a></h2><p>The 3D solver expects an (13, nx, ny, nz) array with:</p><ul><li><p>1: X - 3D meshgrid coordinates </p></li><li><p>2: Y - 3D meshgrid coordinates </p></li><li><p>3: Z - 3D meshgrid coordinates </p></li><li><p>4: P-wave velocities [m/s] </p></li><li><p>5: S-wave velocities [m/s] </p></li><li><p>6: Densities [kg/m<span>$^{3}$</span>] </p></li></ul><p>Tsvankin Parameter </p><ul><li>7: <span>$\varepsilon_1$</span> </li><li>8: <span>$\varepsilon_2$</span> </li><li>9: <span>$\gamma_1$</span> </li><li>10: <span>$\gamma_2$</span> </li><li>11: <span>$\delta_1$</span> </li><li>12: <span>$\delta_2$</span></li><li>13: <span>$\delta_3$</span> </li></ul><p>For an isotropic medium, set 7-13 to zero.</p><p>For a VTI medium, the relationship between Tsvankin and Thomsen Parameters can be used:</p><table><tr><th style="text-align: right">Tsvankin Parameter</th><th style="text-align: right"><code>&lt;=&gt;</code></th><th style="text-align: right">Thomsen Parameter</th></tr><tr><td style="text-align: right"><span>$\varepsilon_1 = \varepsilon_2$</span></td><td style="text-align: right"><code>&lt;=&gt;</code></td><td style="text-align: right"><span>$\varepsilon$</span></td></tr><tr><td style="text-align: right"><span>$\gamma_1 = \gamma_2$</span></td><td style="text-align: right"><code>&lt;=&gt;</code></td><td style="text-align: right"><span>$\gamma$</span></td></tr><tr><td style="text-align: right"><span>$\delta_1 = \delta_2$</span>, <span>$\delta_3 = 0$</span></td><td style="text-align: right"><code>&lt;=&gt;</code></td><td style="text-align: right"><span>$\delta$</span></td></tr></table><p>The following script shows how to create a simple 3D velocity model.</p><pre><code class="language-julia hljs">
using JLD2

# spatial extends
x_start = 0
x_end = 500

y_start = 0 
y_end = 500

z_start = 0
z_end = 500

dx = 5 # cell size x-direction 
dy = 5 # cell size y-direction 
dz = 5 # cell size z-direction 

xcoords = x_start:dx:x_end # x-coordinates
ycoords = y_start:dy:y_end # y-coordinates
zcoords = z_start:dz:z_end # z-coordinates

nx = length(xcoords) # number of grid points x-direction
ny = length(ycoords) # number of grid points y-direction
nz = length(zcoords) # number of grid points z-direction

# 3D Meshgrid
X = getindex.(Iterators.product(xcoords, ycoords, zcoords), 1)
Y = getindex.(Iterators.product(xcoords, ycoords, zcoords), 2)
Z = getindex.(Iterators.product(xcoords, ycoords, zcoords), 3)

dim = (nx, ny, nz) # model dimension

vp = zeros(dim);    # P-wave velocity
vs = zeros(dim);    # S-wave velocity
rho = zeros(dim);   # Density velocity
eps1 = zeros(dim);  # Tsvankin parameter epsilon 1 
eps2 = zeros(dim);  # Tsvankin parameter epsilon 2
gam1 = zeros(dim);  # Tsvankin parameter gamma 1 
gam2 = zeros(dim);  # Tsvankin parameter gamma 2 
del1 = zeros(dim);  # Tsvankin parameter delta 1 
del2 = zeros(dim);  # Tsvankin parameter delta 2 
del3 = zeros(dim);  # Tsvankin parameter delta 3 

# fill arrays with values
vp[:,:,:] .= 5000;
vs[:,:,:]  .= 2500;
rho[:,:,:] .= 2800;

# Tsvankin Parameter
eps1[:,:,:]  .= 0.05
eps2[:,:,:]  .= 0.1
gam1[:,:,:]  .= 0.1
gam2[:,:,:]  .= -0.05
del1[:,:,:]  .= 0.05
del2[:,:,:]  .= 0.025
del3[:,:,:]  .= -0.1

# velocity model array
veldim = (13, nx, ny, nz)
velmod = zeros(veldim);
# fill with elastic properties
velmod[1,:,:,:] .= X
velmod[2,:,:,:] .= Y
velmod[3,:,:,:] .= Z

velmod[4,:,:,:] .= vp
velmod[5,:,:,:] .= vs
velmod[6,:,:,:] .= rho

velmod[7,:,:,:] .= eps1
velmod[8,:,:,:] .= eps2
velmod[9,:,:,:] .= gam1
velmod[10,:,:,:] .= gam2
velmod[11,:,:,:] .= del1
velmod[12,:,:,:] .= del2
velmod[13,:,:,:] .= del3

# save velocity model in jld2 file
using JLD2
path = joinpath(@__DIR__,&quot;velmod.jld2&quot;) # add your actual path here 
jldsave(path; velmod)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../intro/">« General Usage</a><a class="docs-footer-nextpage" href="../config/">Configurations »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Tuesday 28 January 2025 07:44">Tuesday 28 January 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
