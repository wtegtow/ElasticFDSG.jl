<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Method ¬∑ ElasticFDSG.jl</title><meta name="title" content="Method ¬∑ ElasticFDSG.jl"/><meta property="og:title" content="Method ¬∑ ElasticFDSG.jl"/><meta property="twitter:title" content="Method ¬∑ ElasticFDSG.jl"/><meta name="description" content="Documentation for ElasticFDSG.jl."/><meta property="og:description" content="Documentation for ElasticFDSG.jl."/><meta property="twitter:description" content="Documentation for ElasticFDSG.jl."/><meta property="og:url" content="https://wtegtow.github.io/ElasticFDSG.jl/method/"/><meta property="twitter:url" content="https://wtegtow.github.io/ElasticFDSG.jl/method/"/><link rel="canonical" href="https://wtegtow.github.io/ElasticFDSG.jl/method/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="ElasticFDSG.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">ElasticFDSG.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../userguide/intro/">General Usage</a></li><li><a class="tocitem" href="../userguide/velmod/">Velocity Models</a></li><li><a class="tocitem" href="../userguide/config/">Configurations</a></li></ul></li><li class="is-active"><a class="tocitem" href>Method</a><ul class="internal"><li><a class="tocitem" href="#Theory"><span>Theory</span></a></li><li><a class="tocitem" href="#Numerical-Scheme"><span>Numerical Scheme</span></a></li><li><a class="tocitem" href="#Sources"><span>Sources</span></a></li><li><a class="tocitem" href="#C-PML"><span>C-PML</span></a></li><li><a class="tocitem" href="#Validation"><span>Validation</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../reference/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Method</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Method</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/wtegtow/ElasticFDSG.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/wtegtow/ElasticFDSG.jl/blob/main/docs/src/method.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h2 id="Theory"><a class="docs-heading-anchor" href="#Theory">Theory</a><a id="Theory-1"></a><a class="docs-heading-anchor-permalink" href="#Theory" title="Permalink"></a></h2><p>This section provides a brief overview of the theoretical basis of the application. For more comprehensive descriptions, readers are referred to literature listed below.</p><p>Elastic wave propagation in a 3D anisotropic linear elastic material can be described by the following set of first order partial differential equations:</p><p class="math-container">\[\begin{aligned}
\partial_{t} \sigma_{xx} &amp;=  c_{11} \partial_{x} v_{x} + c_{12} \partial_{y} v_{y} + c_{13} \partial_{z} v_{z}  \\ 
\partial_{t} \sigma_{yy} &amp;=  c_{12} \partial_{x} v_{x} + c_{22} \partial_{y} v_{y} + c_{23} \partial_{z} v_{z}  \\
\partial_{t} \sigma_{zz} &amp;=  c_{13} \partial_{x} v_{x} + c_{23} \partial_{y} v_{y} + c_{33} \partial_{z} v_{z}  \\
\partial_{t} \sigma_{xy} &amp;=  c_{66} (\partial_{x} v_{y} + \partial_{y} v_{x})  \\
\partial_{t} \sigma_{xz} &amp;=  c_{55} (\partial_{x} v_{z} + \partial_{z} v_{x})  \\
\partial_{t} \sigma_{yz} &amp;=  c_{44} (\partial_{y} v_{z} + \partial_{z} v_{y}) \tag{1} \\

\end{aligned}\]</p><p class="math-container">\[\begin{aligned}
\rho \partial_{t} v_{x} &amp;= \partial_{x} \sigma_{xx} + \partial_{y} \sigma_{xy} + \partial_{z} \sigma_{xz}  \\
\rho \partial_{t} v_{y} &amp;= \partial_{x} \sigma_{xy} + \partial_{y} \sigma_{yy} + \partial_{z} \sigma_{yz}  \\
\rho \partial_{t} v_{z} &amp;= \partial_{x} \sigma_{xz} + \partial_{y} \sigma_{xz} + \partial_{z} \sigma_{zz}  \tag{2} \\
\end{aligned}\]</p><p>In these equations:</p><ul><li>are <span>$\sigma_{xx}, \sigma_{yy}, \sigma_{zz}$</span> the normal stress components.</li><li>are <span>$\sigma_{xy}, \sigma_{xz}, \sigma_{yz}$</span> the shear stress components.</li><li>are <span>$c_{11}, c_{12}, c_{13}, c_{22}, c_{23}, c_{33}, c_{44}, c_{55}, c_{66}$</span> the 9 elastic constants needed to describe an orthorhombic material.</li><li>is <span>$\rho$</span> is the density of the material.</li><li>are <span>$v_{x}, v_{y}, v_{z}$</span> the particle velocities in the <span>$x$</span>, <span>$y$</span>, and <span>$z$</span> directions, respectively.</li></ul><p>Using the Tsvankin notation, isotropic, vertical transversal isotropic (VTI) and ortorhombic materials (ORT) can be characterized by two vertical velocities and 7 dimensionless paramters <span>$\epsilon_{1}, \epsilon_{2}, \gamma_{1}, \gamma_{2}, \delta_{1}, \delta_{2}, \delta_{3}$</span> :</p><p class="math-container">\[\begin{aligned}
c_{33} &amp;= v_{p0}^2 \cdot \rho \\
c_{55} &amp;= v_{s0}^2 \cdot \rho \\
c_{11} &amp;= (2 \epsilon_{2} + 1) \cdot c_{33} \\
c_{22} &amp;= c_{33} \cdot (2 \epsilon_{1} + 1) \\
c_{66} &amp;= c_{55} \cdot (2 \gamma_{1} + 1) \\
c_{44} &amp;= \frac{c_{66}}{1 + \gamma_{2}} \\
c_{13} &amp;= \sqrt{2 c_{33} \cdot (c_{33} - c_{55}) \cdot \delta_{2} + (c_{33} - c_{55})^2} - c_{55} \\
c_{23} &amp;= \sqrt{2 c_{33} \cdot (c_{33} - c_{44}) \cdot \delta_{1} + (c_{33} - c_{44})^2} - c_{44} \\
c_{12} &amp;= \sqrt{2 c_{11} \cdot (c_{11} - c_{66}) \cdot \delta_{3} + (c_{11} - c_{66})^2} - c_{66}
\end{aligned}\]</p><h2 id="Numerical-Scheme"><a class="docs-heading-anchor" href="#Numerical-Scheme">Numerical Scheme</a><a id="Numerical-Scheme-1"></a><a class="docs-heading-anchor-permalink" href="#Numerical-Scheme" title="Permalink"></a></h2><p>The set of equations (1) and (2) can be solved using a finite-difference staggered-grid scheme. In a staggered grid, field quantities are not co-located on same grid points but are distributed across predefined grid cells. The primary advantage of a staggered grid is an enhanced accuracy of spatial central difference operators, as well as staggered temporal finite difference operators, which also improves the accuracy of the time marching.</p><p>However, the distribution of field quantities within a grid cell also has drawbacks, especially during the processing of the results. For example, users working with geophone data must consider that the velocity components <span>$v_{x}, v_{y}, v_{z}$</span> are not measured at the same location.</p><p>The staggered grid scheme used in the application is illustrated below:</p><pre><code class="nohighlight hljs">      ‚Üë y                           ‚îÇ      y              ‚ñ≥             ‚ñ† v‚Çì  i,j,k
        ‚îÇ         i+¬Ω,j+¬Ω           ‚îÇ  z‚Üë /              /              ‚óÜ v·µß  i+¬Ω,j+¬Ω,k
  i,j+¬Ω ‚îÇ         ‚îÇv·µß               ‚îÇ   ‚îÇ/              /               ‚óè vùëß  i+¬Ω,j,k+¬Ω 
   œÉ‚Çì·µß ‚îÄ‚óá‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚óÜ‚îÄ‚îÄ‚îÄ              ‚îÇ   ‚óã ............ ‚óè
        ‚îÇ         ‚îÇ                 ‚îÇ   ‚ïé              ‚ïé                ‚ñ° œÉ‚Çì‚Çì,œÉ·µß·µß,œÉùëßùëß i+¬Ω,j,k
        ‚îÇ         ‚îÇ                 ‚îÇ   ‚ïé              ‚ïé                ‚óã œÉ‚Çìùëß i,j,k+¬Ω
        ‚îÇ         ‚îÇ                 ‚îÇ   ‚ïé   ‚óá          ‚ïé  ‚óÜ             ‚óá œÉ‚Çì·µß i,j+¬Ω,k
        ‚ñ†‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ°‚îÄ‚îÄ‚îÄ‚îÄ ‚îÄ‚îÄ‚Üí x       ‚îÇ   ‚ïé  /           ‚ïé /              ‚ñ≥ œÉ·µßùëß i+¬Ω,j+¬Ω,k+¬Ω
        v‚Çì      œÉ‚Çì‚Çì,œÉ·µß·µß             ‚îÇ   ‚ïé /            ‚ïé/  
       i,j       i+¬Ω,j              ‚îÇ   ‚ñ† ............ ‚ñ° ‚îÄ‚Üí x 
                                    ‚îÇ</code></pre><p>Using this scheme, the discrete form of (1) and (2) are given by:</p><p class="math-container">\[\begin{aligned}

\sigma_{xx \; (i+\frac{1}{2},j,k)}^{t_{n}+\frac{1}{2}} &amp;= \sigma_{xx \; (i+\frac{1}{2},j,k)}^{t_{n}-\frac{1}{2}} \Delta t (c_{11} \mathcal{D}_{x} v_{x} + c_{12} \mathcal{D}_{y} v_{y} + c_{13} \mathcal{D}_{z} v_{z} ) \bigg|_{(i+\frac{1}{2},j,k)}^{t_{n}} \\ 

\sigma_{yy \; (i+\frac{1}{2},j,k)}^{t_{n}+\frac{1}{2}} &amp;= \sigma_{yy \; (i+\frac{1}{2},j,k)}^{t_{n}-\frac{1}{2}} \Delta t (c_{12} \mathcal{D}_{x} v_{x} + c_{22} \mathcal{D}_{y} v_{y} + c_{23} \mathcal{D}_{z} v_{z} ) \bigg|_{(i+\frac{1}{2},j,k)}^{t_{n}} \\ 

\sigma_{zz \; (i+\frac{1}{2},j,k)}^{t_{n}+\frac{1}{2}} &amp;= \sigma_{zz \; (i+\frac{1}{2},j,k)}^{t_{n}-\frac{1}{2}} \Delta t (c_{13} \mathcal{D}_{x} v_{x} + c_{23} \mathcal{D}_{y} v_{y} + c_{33} \mathcal{D}_{z} v_{z} ) \bigg|_{(i+\frac{1}{2},j,k)}^{t_{n}} \\ 

\sigma_{xy \; (i,j+\frac{1}{2},k)}^{t_{n}+\frac{1}{2}} &amp;= \sigma_{xy \; (i,j+\frac{1}{2},k)}^{t_{n}-\frac{1}{2}} \Delta t \, c_{66} ( \mathcal{D}_{x} v_{y} +  \mathcal{D}_{y} v_{x})\bigg|_{(i,j+\frac{1}{2},k)}^{t_{n}} \\

\sigma_{xz \; (i,j,k+\frac{1}{2})}^{t_{n}+\frac{1}{2}} &amp;= \sigma_{xz \; (i,j,k+\frac{1}{2})}^{t_{n}-\frac{1}{2}} \Delta t \, c_{55} ( \mathcal{D}_{x} v_{z} + \mathcal{D}_{z} v_{x})\bigg|_{(i,j,k+\frac{1}{2})}^{t_{n}} \\

\sigma_{yz \; (i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2})}^{t_{n}+\frac{1}{2}} &amp;= \sigma_{yz \; (i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2})}^{t_{n}-\frac{1}{2}} \Delta t \, c_{44} ( \mathcal{D}_{y} v_{z} +  \mathcal{D}_{y} v_{z})\bigg|_{(i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2})}^{t_{n}} \\
            
            
\end{aligned}\]</p><p class="math-container">\[\begin{aligned}
v_{x \; (i,j,k)}^{t_{n}+1} &amp;= v_{x \; (i,j,k)}^{t_{n}} \frac{\Delta t}{\rho} (\mathcal{D}_{x} \sigma_{xx} + \mathcal{D}_{y} \sigma_{xy} + \mathcal{D}_{z} \sigma_{xz}) \bigg|_{(i,j,k)}^{t_{n}+\frac{1}{2}} \\
v_{y \; (i+\frac{1}{2},j+\frac{1}{2},k)}^{t_{n}+1} &amp;= v_{y \; (i+\frac{1}{2},j+\frac{1}{2},k)}^{t_{n}} \frac{\Delta t}{\rho} (\mathcal{D}_{x} \sigma_{xy} + \mathcal{D}_{y} \sigma_{yy} + \mathcal{D}_{z} \sigma_{yz}) \bigg|_{(i+\frac{1}{2},j+\frac{1}{2},k)}^{t_{n}+\frac{1}{2}} \\
v_{z \; (i+\frac{1}{2},j,k+\frac{1}{2})}^{t_{n}+1} &amp;= v_{z \; (i+\frac{1}{2},j,k+\frac{1}{2})}^{t_{n}} \frac{\Delta t}{\rho} (\mathcal{D}_{x} \sigma_{xz} + \mathcal{D}_{y} \sigma_{xz} + \mathcal{D}_{z} \sigma_{zz}) \bigg|_{(i+\frac{1}{2},j,k+\frac{1}{2})}^{t_{n}+\frac{1}{2}} \tag{3}

\end{aligned}\]</p><p>Here <span>$(i,j,k)$</span> represent the grid points in the x,y,z-directions, respectively;  <span>$t_{n}$</span> denotes the <span>$n$</span>-th time step;  and <span>$\Delta t$</span> the time increment.</p><p>The differential operators <span>$\mathcal{D}$</span> are given by central difference approximations:</p><p class="math-container">\[\begin{aligned}

\mathcal{D_{x}} f = \sum_{n=1}^{N} \frac{c_{n}}{\Delta x} ( f(x_{i+n}, y_{j}, z_{k}) - f(x_{i- n}, y_{j}, z_{k})) \\
\mathcal{D_{y}} f = \sum_{n=1}^{N} \frac{c_{n}}{\Delta y} ( f(x_{i}, y_{j+n}, z_{k}) - f(x_{i}, y_{j-n}, z_{k})) \\
\mathcal{D_{z}} f = \sum_{n=1}^{N} \frac{c_{n}}{\Delta z} ( f(x_{i}, y_{j}, z_{k+n}) - f(x_{i}, y_{j}, z_{k-n}))
        
\end{aligned}\]</p><p>with order <span>$N$</span> and coefficients <span>$c_{n}$</span>.</p><p>To compute a spatial derivative of order <span>$N$</span> at a specific location, at least <span>$N$</span> neighboring nodes are required on both sides. As a result, for edge nodes no spatial derivatives can be calculated. These edge nodes (ghost nodes) are effective model boundaries and should lie outside the physical (user-defined) domain. The application automatically extends the user-defined domain with <span>$N$</span> ghost node layers.</p><p>In staggered grids, it is often beneficial to assign certain elastic properties to specific points within the grid cell. However, requiring users to define such grids can become difficult to manage, particularly for complex media. To simplify this, we define all elastic properties at full integer grid points (e.g., on <span>$v_{x}$</span>) and effective properties are calculated by interpolating values from neighboring nodes.</p><h2 id="Sources"><a class="docs-heading-anchor" href="#Sources">Sources</a><a id="Sources-1"></a><a class="docs-heading-anchor-permalink" href="#Sources" title="Permalink"></a></h2><p>Earthquake simulations require the excitation of external double-couple sources. Source terms can be introduced in two different ways:</p><ul><li>As body-force terms acting on the velocity field (e.g., Virieux, 1984). </li><li>As incremental stresses acting on the stress field (e.g., Shi et al., 2018).</li></ul><p>In the SG scheme shown above, using incremental stresses requires fewer terms and results in fewer numerical ambiguities compared to body forces, due to the distribution of velocity nodes around a source node.</p><p>A moment tensor source can be described by:</p><p class="math-container">\[\begin{aligned}
\mathbf{F}(t) = m_0 \, \boldsymbol{M} \, \text{STF}(t),
\end{aligned}\]</p><p>where <span>$m_0$</span> is the seismic moment, <span>$\text{STF}(t)$</span> is the source time function, and <span>$\boldsymbol{M}$</span> is the moment tensor with components:</p><pre><code class="nohighlight hljs">M = [ Mxx  Mxy  Mxz
      Mxy  Myy  Myz
      Mxz  Myz  Mzz ]</code></pre><p>Assuming a moment-tensor source acting on the stress field, the nearest normal stress node (i+1/2,j,k) serves as the central point. To obtain a symmetrical solution, the shear stress components are then distributed symmetrically around this central node. Thus, in total three normal and twelve shear stress components are required for the full staggered grid formulation:</p><p class="math-container">\[\begin{aligned}

V &amp;= \Delta x \Delta y \Delta z \\ \\

\sigma_{xx\; (i+\frac{1}{2},j,k)} &amp;\mathrel{-}= \frac{\Delta t}{V} M_{xx} \, \frac{\partial \text{STF}}{\partial t} \\
\sigma_{yy\; (i+\frac{1}{2},j,k)} &amp;\mathrel{-}= \frac{\Delta t}{V} M_{yy} \, \frac{\partial \text{STF}}{\partial t} \\
\sigma_{zz\; (i+\frac{1}{2},j,k)} &amp;\mathrel{-}= \frac{\Delta t}{V} M_{zz} \, \frac{\partial \text{STF}}{\partial t} \\[0.5em]

\sigma_{xy\; (i,j+\frac{1}{2},k)} &amp;\mathrel{-}= \frac{\Delta t}{4 V} M_{xy} \, \frac{\partial \text{STF}}{\partial t} \\
\sigma_{xy\; (i+1,j+\frac{1}{2},k)} &amp;\mathrel{-}= \frac{\Delta t}{4 V} M_{xy} \, \frac{\partial \text{STF}}{\partial t} \\
\sigma_{xy\; (i,j-\frac{1}{2},k)} &amp;\mathrel{-}= \frac{\Delta t}{4 V} M_{xy} \, \frac{\partial \text{STF}}{\partial t} \\
\sigma_{xy\; (i+1,j-\frac{1}{2},k)} &amp;\mathrel{-}= \frac{\Delta t}{4 V} M_{xy} \, \frac{\partial \text{STF}}{\partial t} \\[0.5em]

\sigma_{xz\; (i,j,k+\frac{1}{2})} &amp;\mathrel{-}= \frac{\Delta t}{4 V} M_{xz} \, \frac{\partial \text{STF}}{\partial t} \\
\sigma_{xz\; (i+1,j,k+\frac{1}{2})} &amp;\mathrel{-}= \frac{\Delta t}{4 V} M_{xz} \, \frac{\partial \text{STF}}{\partial t} \\
\sigma_{xz\; (i,j,k-\frac{1}{2})} &amp;\mathrel{-}= \frac{\Delta t}{4 V} M_{xz} \, \frac{\partial \text{STF}}{\partial t} \\
\sigma_{xz\; (i,j,k-\frac{1}{2})} &amp;\mathrel{-}= \frac{\Delta t}{4 V} M_{xz} \, \frac{\partial \text{STF}}{\partial t} \\[0.5em]

\sigma_{yz\; (i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2})} &amp;\mathrel{-}= \frac{\Delta t}{4 V} M_{yz} \, \frac{\partial \text{STF}}{\partial t} \\
\sigma_{yz\; (i+\frac{1}{2},j+\frac{1}{2},k-\frac{1}{2})} &amp;\mathrel{-}= \frac{\Delta t}{4 V} M_{yz} \, \frac{\partial \text{STF}}{\partial t} \\
\sigma_{yz\; (i+\frac{1}{2},j-\frac{1}{2},k+\frac{1}{2})} &amp;\mathrel{-}= \frac{\Delta t}{4 V} M_{yz} \, \frac{\partial \text{STF}}{\partial t} \\
\sigma_{yz\; (i+\frac{1}{2},j-\frac{1}{2},k-\frac{1}{2})} &amp;\mathrel{-}= \frac{\Delta t}{4 V} M_{yz} \, \frac{\partial \text{STF}}{\partial t},
\end{aligned}\]</p><p>where the notation <span>$x \mathrel{-}= 1$</span> -&gt; <span>$x = x - 1$</span> is used.</p><p>Users who want to model shear slip earthquake sources can compute the moment tensor components using dip, strike, and rake values.  For example, defining the following coordinate system:</p><pre><code class="nohighlight hljs">     x                  
   /                     
  /                        Œ¥ = Dip, Œª = Rake, Œ¶ = Strike                
  ---- y                   Coordinate System: x -&gt; north,            
 |                                            y -&gt; east,
 |                                            z -&gt; positive downward
 z</code></pre><p>Moment tensor components are given by:</p><p class="math-container">\[\begin{aligned}
M_{xx} &amp;= -(sin(\delta) \, cos(\lambda) \, sin(2\Phi) + sin(2\delta) \, sin(\lambda) \, sin(\Phi)^{2}) \\
M_{xy} &amp;= \sin(\delta) \, \cos(\lambda) \, \cos(2\Phi) + \frac{1}{2} \sin(2\delta) \, \sin(\lambda) \, \sin(2\Phi) \\
M_{xz} &amp;= -(\cos(\delta) \, \cos(\lambda) \, \cos(\Phi) + \cos(2\delta) \, \sin(\lambda) \, \sin(\Phi)) \\
M_{yy} &amp;= \sin(\delta) \, \cos(\lambda) \, \sin(2\Phi) - \sin(2\delta) \, \sin(\lambda) \, \cos(\Phi)^2 \\
M_{yz} &amp;= -(\cos(\delta) \, \cos(\lambda) \, \sin(\Phi) - \cos(2\delta) \, \sin(\lambda) \, \cos(\Phi)) \\
M_{zz} &amp;= \sin(2\delta) \, \sin(\lambda)
\end{aligned}\]</p><h2 id="C-PML"><a class="docs-heading-anchor" href="#C-PML">C-PML</a><a id="C-PML-1"></a><a class="docs-heading-anchor-permalink" href="#C-PML" title="Permalink"></a></h2><p>Earthquake simulations often require modeling wave propagation in unbounded media. Perfectly Matched Layers (PML) is a very effective method to prevent artificial reflections at model boundaries. The underlying idea is to manipulate the wave equation to obtain exponentially decaying plane wave solutions for complex arguments. Assuming that the computational domain (real arguments) is surrounded by a complex region (the PML region), the amplitudes of incident waves decay and cause negligible reflections at the computational boundaries.</p><p>Komatitsch &amp; Martin (2007) introduced a memory efficient convolution-based unsplit PML formulation (C-PML).  This approach requires storing only one additional memory variable for each spatial derivative, but in the PML region only. For the PML region, spatial derivative operators are replaced by:</p><p class="math-container">\[\begin{aligned}
\mathcal{D}_{\hat{x}} &amp;= \frac{\mathcal{D_{x}}}{\kappa_{x}} + \Psi_{x} \tag{4}
\end{aligned}\]</p><p>Here, <span>$\Psi_{x}$</span> represents the memory variable associated with the field from which the derivative is taken. The memory variable <span>$\Psi_{x}$</span> is updated at each time step by:</p><p class="math-container">\[\begin{aligned}
\Psi_{x}^{t_{n}} &amp;= b_{x} \Psi_{x}^{t_{n}-1} + a_{x} (\mathcal{D_{x}})^{t_{n} + \frac{1}{2}} \tag{5}
\end{aligned}\]</p><p>while <span>$a_{x}$</span>, <span>$b_{x}$</span> <span>$\kappa_{x}$</span> are precomputed PML related parameter.  Accordingly, differential operators <span>$\mathcal{D_{y}}$</span> and <span>$\mathcal{D_{z}}$</span> are replaced by <span>$\mathcal{D}_{\hat{y}}$</span> and <span>$\mathcal{D}_{\hat{z}}$</span> in the PML-region. </p><h2 id="Validation"><a class="docs-heading-anchor" href="#Validation">Validation</a><a id="Validation-1"></a><a class="docs-heading-anchor-permalink" href="#Validation" title="Permalink"></a></h2><p>To validate the implementation, numerically derived seismograms are compared with analytical solutions for a homogeneous medium for three different moment tensor sources:  </p><ul><li>isotropic (explosive, ISO),  </li><li>double couple (DC), and  </li><li>compensated linear vector dipole (CLVD),  </li></ul><p>given by:</p><p class="math-container">\[M_{\text{ISO}} =
\begin{bmatrix}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1
\end{bmatrix},
\quad
M_{\text{DC}} =
\begin{bmatrix}
0 &amp; 1 &amp; 0 \\
1 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0
\end{bmatrix},
\quad
M_{\text{CLVD}} =
\begin{bmatrix}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; -2
\end{bmatrix}.\]</p><p>Analytical solutions can be obtained by convolving the moment tensors with the Green‚Äôs function. For a Cartesian coordinate system that origins at a source location <span>$\xi_{x,y,z}$</span>, and a receiver located at <span>$x_{x,y,z}$</span>, we define:</p><p class="math-container">\[\begin{aligned}
r  &amp;= |\xi_{x,y,z} - x_{x,y,z}|, \\
\gamma_{x,y,z} &amp;= (\xi_{x,y,z} - x_{x,y,z})/r.
\end{aligned}\]</p><p>The analytical displacement is then given by (Aki and Richards (2002)):</p><p class="math-container">\[\begin{aligned}
u_n &amp;= M_{pq} * G_{np,q} \\[1ex]
    &amp;= R_{ne} \, \frac{M_0}{4 \pi \rho r^4} 
       \int_{r/v_s}^{r/v_p} \tau \, S(t - \tau) \, d\tau \\[1ex]
    &amp;\quad + R_{ip} \, \frac{1}{4 \pi \rho v_p^2 r^2} \, S(t - r/v_p) \\[1ex]
    &amp;\quad + R_{is} \, \frac{1}{4 \pi \rho v_s^2 r^2} \, S(t - r/v_s) \\[1ex]
    &amp;\quad + R_{fp} \, \frac{1}{4 \pi \rho v_p^3 r} \, \dot{S}(t - r/v_p) \\[1ex]
    &amp;\quad + R_{fs} \, \frac{1}{4 \pi \rho v_s^3 r} \, \dot{S}(t - r/v_s),
\end{aligned}\]</p><p>with the near field term <span>$R_{ne}$</span> give by:</p><p class="math-container">\[\begin{aligned}
R_{ne} =
\left( 15 \gamma_n \gamma_p \gamma_q
     - 3 \gamma_n \delta_{pq}
     - 3 \gamma_p \delta_{nq}
     - 3 \gamma_q \delta_{np} \right) M_{pq},
\end{aligned}\]</p><p>the p-wave intermediate field term <span>$R_{ip}$</span> give by: </p><p class="math-container">\[\begin{aligned}
R_{ip} =
\left( 6 \gamma_n \gamma_p \gamma_q
     - \gamma_n \delta_{pq}
     - \gamma_p \delta_{nq}
     - \gamma_q \delta_{np} \right) M_{pq},
\end{aligned}\]</p><p>the s-wave intermediate field term <span>$R_{is}$</span> give by: </p><p class="math-container">\[\begin{aligned}
R_{is} =
-\left( 6 \gamma_n \gamma_p \gamma_q
      - \gamma_n \delta_{pq}
      - \gamma_p \delta_{nq}
      - 2 \gamma_q \delta_{np} \right) M_{pq},

\end{aligned}\]</p><p>the p-wave far field term <span>$R_{fp}$</span> give by: </p><p class="math-container">\[\begin{aligned}
R_{fp} = \left( \gamma_n \gamma_p \gamma_q \right) M_{pq},
\end{aligned}\]</p><p>and the s-wave far field term <span>$R_{fs}$</span> give by: </p><p class="math-container">\[\begin{aligned}
R_{fs} = -\left( \gamma_n \gamma_p \gamma_q - \delta_{np} \gamma_q \right) M_{pq},
\end{aligned}\]</p><p>where <span>$\delta_{np}$</span> denotes the Kronecker delta, and <span>$\dot{S}$</span> the first derivative of the source time function.</p><p>The following figure compares numerically forward-modeled seismograms with analytical solutions for all three moment tensors. Analyitical velocities are obtained by differentiating the displacement.</p><p><img src="../assets/validation.png" alt="valid"/></p><p>As shown, all errors remain within a reasonable range and confirm implementation of elastic wave propagation and moment tensor sources.</p><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><p>Aki, K., &amp; Richards, P. G. (2002). Quantitative seismology.</p><p>Komatitsch, D., &amp; Martin, R. (2007). An unsplit convolutional perfectly matched layer improved at grazing incidence for the seismic wave equation. Geophysics, 72(5), SM155-SM167.</p><p>Moczo, P., Kristek, J., &amp; G√°lis, M. (2014). The finite-difference modelling of earthquake motions: Waves and ruptures. Cambridge University Press.</p><p>Shi, P., Angus, D., Nowacki, A., Yuan, S., &amp; Wang, Y. (2018). Microseismic full waveform modeling in anisotropic media with moment tensor implementation. Surveys in Geophysics, 39(4), 567-611.</p><p>Tsvankin, I. (1997). Anisotropic parameters and P-wave velocity for orthorhombic media. Geophysics, 62(4), 1292-1309.</p><p>Virieux, J. (1984). SH-wave propagation in heterogeneous media: Velocity-stress finite-difference method. Geophysics, 49(11), 1933-1942. </p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../userguide/config/">¬´ Configurations</a><a class="docs-footer-nextpage" href="../reference/">API Reference ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Thursday 25 September 2025 07:07">Thursday 25 September 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
